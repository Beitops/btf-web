---
import ReviewsBar from "../widgets/ReviewsBar.astro";
---

<section class="bg-primary pt-16 pb-56 px-6">
	<div class="max-w-4xl mx-auto text-center">
		<h1 class="text-4xl md:text-5xl font-bold leading-tight mb-6">
			Compara y baja tu factura de<br/>
			luz <span class="font-normal italic">sin llamadas.</span>
		</h1>
		<h2 class="text-base md:text-lg text-gray-800 mb-12">
			Arrastra tu factura y comprueba si estás pagando<br/>
			lo justo de forma totalmente gratuita.
		</h2>
	</div>
</section>

<div class="px-6 -mt-55 relative z-10 pb-16">
	<div class="max-w-3xl mx-auto">
		<div 
			id="dropzone"
			class="bg-white rounded-[50px] border border-black py-32 md:py-40 px-16 cursor-pointer shadow-xl transition-all hover:border-gray-300 hover:shadow-lg"
		>
			<div class="flex flex-col items-center justify-center">
				<p id="dropzone-text" class="text-black text-lg font-light">Arrastra tu factura aquí</p>
				<input 
					type="file" 
					id="file-input" 
					accept=".pdf,image/*" 
					class="hidden"
				/>
			</div>
		</div>
		<div class="mt-6 flex justify-center">
			<ReviewsBar />
		</div>
	</div>
</div>

<script>
	const dropzone = document.getElementById('dropzone');
	const fileInput = document.getElementById('file-input') as HTMLInputElement;
	const dropzoneText = document.getElementById('dropzone-text');

	// Click to open file picker
	dropzone?.addEventListener('click', () => {
		fileInput?.click();
	});

	// Handle file selection
	fileInput?.addEventListener('change', (e) => {
		const target = e.target as HTMLInputElement;
		if (target.files && target.files.length > 0) {
			handleFile(target.files[0]);
		}
	});

	// Drag and drop events
	dropzone?.addEventListener('dragover', (e) => {
		e.preventDefault();
		dropzone.classList.add('border-black', 'bg-gray-50');
		dropzone.classList.remove('border-gray-200');
	});

	dropzone?.addEventListener('dragleave', (e) => {
		e.preventDefault();
		dropzone.classList.remove('border-black', 'bg-gray-50');
		dropzone.classList.add('border-gray-200');
	});

	dropzone?.addEventListener('drop', (e) => {
		e.preventDefault();
		dropzone.classList.remove('border-black', 'bg-gray-50');
		dropzone.classList.add('border-gray-200');
		
		const files = e.dataTransfer?.files;
		if (files && files.length > 0) {
			const file = files[0];
			// Check if file is PDF or image
			if (file.type === 'application/pdf' || file.type.startsWith('image/')) {
				handleFile(file);
			} else {
				alert('Por favor, sube un archivo PDF o una imagen.');
			}
		}
	});

	function handleFile(file: File) {
		if (dropzoneText) {
			dropzoneText.textContent = `Archivo seleccionado: ${file.name}`;
			dropzoneText.classList.remove('text-gray-500');
			dropzoneText.classList.add('text-black', 'font-medium');
		}
		// Here you can add logic to process the file
		console.log('File uploaded:', file.name, file.type, file.size);
	}
</script>
